services:
  minion:
    image: opennms/minion:33.0.2
    container_name: chongjin-minion
    hostname: chongjin-minion
    environment:
      MINION_ID: chongjin-minion-01
      MINION_LOCATION: Chongjin
      OPENNMS_HTTP_URL: http://pyu-horizon:8980/opennms
      OPENNMS_HTTP_USER: admin
      OPENNMS_HTTP_PASS: admin
      OPENNMS_BROKER_URL: tcp://pyu-activemq:61616
    command: ["-c"]
    entrypoint: ["/opt/minion-startup.sh"]
    volumes:
      - minion-data:/opt/minion-data
      - ./minion-startup.sh:/opt/minion-startup.sh:ro
      - ./opennms.properties.d:/opt/minion/etc/opennms.properties.d:ro
    ports:
      - "8202:8201/tcp"
    networks:
      kafka_pyu-main:
        ipv4_address: 172.18.0.14

volumes:
  minion-data:

networks:
  kafka_pyu-main:
    external: true

# Jose Vasconcelos - Jan 2026
# GitHub - KariocaMarron
# Static IP configured for stability
